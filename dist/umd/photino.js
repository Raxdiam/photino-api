var p=Object.defineProperty;var v=(s,h,a)=>h in s?p(s,h,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[h]=a;var d=(s,h,a)=>(v(s,typeof h!="symbol"?h+"":h,a),a);(function(s,h){typeof exports=="object"&&typeof module!="undefined"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(s=typeof globalThis!="undefined"?globalThis:s||self,h(s.PhotinoAPI={}))})(this,function(s){"use strict";function h(){let i=new Date().getTime();return"xxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(i+Math.random()*16)%16|0;return i=Math.floor(i/16),(t=="x"?n:n&3|8).toString(16)})}class a{constructor(e){d(this,"id");d(this,"data");this.id=h(),this.data=e}}class o{send(e,...t){return s.Photino.send(this.name,e,...t)}}class f extends o{constructor(){super(...arguments);d(this,"name","app")}exit(e){return this.send(this.exit.name,e)}cwd(){return this.send(this.cwd.name)}}class w extends o{constructor(){super(...arguments);d(this,"name","io")}readFile(e){return this.send(this.readFile.name,e)}readFileText(e,t=null){return this.send(this.readFileText.name,e,t)}readFileLines(e,t=null){return this.send(this.readFileLines.name,e,t)}writeFile(e,t){return this.send(this.writeFile.name,e,t)}writeFileText(e,t,n=null){return this.send(this.writeFileText.name,e,t,n)}writeFileLines(e,t,n=null){return this.send(this.writeFileLines.name,e,t,n)}moveFile(e,t){return this.send(this.moveFile.name,e,t)}moveFolder(e,t){return this.send(this.moveFolder.name,e,t)}listFiles(e,t=null,n=!1){return this.send(this.listFiles.name,e,t,n)}listFolders(e,t=null,n=!1){return this.send(this.listFolders.name,e,t,n)}createFolder(e){return this.send(this.createFolder.name,e)}deleteFile(e){return this.send(this.deleteFile.name,e)}deleteFolder(e,t=!1){return this.send(this.deleteFolder.name,e,t)}fileExists(e){return this.send(this.fileExists.name,e)}folderExists(e){return this.send(this.folderExists.name,e)}resolvePath(e){return this.send(this.resolvePath.name,e)}getExtension(e){return this.send(this.getExtension.name,e)}}class M extends o{constructor(){super(...arguments);d(this,"name","osModule")}isWindows(){return this.send(this.isWindows.name)}isLinux(){return this.send(this.isLinux.name)}isMacOs(){return this.send(this.isMacOs.name)}getEnvar(e){return this.send(this.getEnvar.name,e)}cmd(e){return this.send(this.cmd.name,e)}showOpenFile(e,t,n=!1,r=null){return this.send(this.showOpenFile.name,e,t,n,r)}showSaveFile(e,t,n=null){return this.send(this.showSaveFile.name,e,t,n)}showSelectFolder(e,t=null){return this.send(this.showSelectFolder.name,e,t)}}class F extends o{constructor(){super(...arguments);d(this,"name","window")}getTitle(){return this.send(this.getTitle.name)}getMaximized(){return this.send(this.getMaximized.name)}getMinimized(){return this.send(this.getMinimized.name)}getDevToolsEnabled(){return this.send(this.getDevToolsEnabled.name)}getContextMenuEnabled(){return this.send(this.getContextMenuEnabled.name)}getTopMost(){return this.send(this.getTopMost.name)}getChromeless(){return this.send(this.getChromeless.name)}getFullScreen(){return this.send(this.getFullScreen.name)}getResizable(){return this.send(this.getResizable.name)}getWidth(){return this.send(this.getWidth.name)}getHeight(){return this.send(this.getHeight.name)}getTop(){return this.send(this.getTop.name)}getLeft(){return this.send(this.getLeft.name)}setTitle(e){return this.send(this.setTitle.name,e)}setMaximized(e){return this.send(this.setMaximized.name,e)}setMinimized(e){return this.send(this.setMinimized.name,e)}setDevToolsEnabled(e){return this.send(this.setDevToolsEnabled.name,e)}setContextMenuEnabled(e){return this.send(this.setContextMenuEnabled.name,e)}setTopMost(e){return this.send(this.setTopMost.name,e)}setChromeless(e){return this.send(this.setChromeless.name,e)}setFullScreen(e){return this.send(this.setFullScreen.name,e)}setResizable(e){return this.send(this.setResizable.name,e)}setWidth(e){return this.send(this.setWidth.name,e)}setHeight(e){return this.send(this.setHeight.name,e)}setTop(e){return this.send(this.setTop.name,e)}setLeft(e){return this.send(this.setLeft.name,e)}close(){return this.send(this.close.name)}load(e){return this.send(this.load.name,e)}loadRawString(e){return this.send(this.loadRawString.name,e)}showSystemMenu(){return this.send(this.showSystemMenu.name)}center(){return this.send(this.center.name)}hitTest(e){s.Photino.sendRaw(`ht:${e}`)}drag(){this.hitTest("drag")}left(){this.hitTest("left")}right(){this.hitTest("right")}top(){this.hitTest("top")}topLeft(){this.hitTest("topLeft")}topRight(){this.hitTest("topRight")}bottom(){this.hitTest("bottom")}bottomLeft(){this.hitTest("bottomLeft")}bottomRight(){this.hitTest("bottomRight")}}class T extends o{constructor(){super();d(this,"listeners");d(this,"name","events");this.listeners={},window.external.receiveMessage(e=>{if(!e.startsWith("ev:"))return;let t,n;if(e.includes("|")){const r=e.split("|");t=r[0].split(":")[1];let l;r[1].includes(",")?l=r[1].split(",").map(m=>m.split("=")):l=[r[1].split("=")],n=Object.fromEntries(l)}else t=e.split(":")[1];if(!!t&&!!this.listeners[t])for(const r of this.listeners[t])r(n)})}on(e,t){this.listeners[e]||(this.listeners[e]=[]),s.Photino.sendRaw(`ev:${e}`),this.listeners[e].push(t)}reset(){this.listeners={},s.Photino.sendRaw("ev:reset")}}const c=window;s.Photino=void 0,function(i){i.app=new f,i.io=new w,i.os=new M,i.window=new F,i.events=new T;async function e(r,l,...m){const u=await t({module:r,method:l,parameters:m});if(u.error)throw new Error(u.error);return u.result}i.send=e;function t(r){var l=new a(r);return c.external.sendMessage(`api:${JSON.stringify(l)}`),new Promise(m=>{const x=setTimeout(()=>{throw new Error("Request timed out")},1e4);c.external.receiveMessage(u=>{if(!u.startsWith("api:"))return;const g=JSON.parse(u.substring(4));g.id===l.id&&(clearTimeout(x),m(g.data))})})}async function n(r){c.external.sendMessage(r)}i.sendRaw=n}(s.Photino||(s.Photino={})),s.PhotinoModule=o,Object.defineProperty(s,"__esModule",{value:!0}),s[Symbol.toStringTag]="Module"});
